<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>dns协议 | ALeeLee 的博客 ｜ ALeeLee Blog</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/vueblog/favicon.ico">
    <meta name="description" content="个人博客，前端开发">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/vueblog/assets/css/0.styles.13617540.css" as="style"><link rel="preload" href="/vueblog/assets/js/app.fdc44102.js" as="script"><link rel="preload" href="/vueblog/assets/js/8.890bf07c.js" as="script"><link rel="preload" href="/vueblog/assets/js/25.41573d9b.js" as="script"><link rel="prefetch" href="/vueblog/assets/js/10.ccfcf924.js"><link rel="prefetch" href="/vueblog/assets/js/11.fffff3ae.js"><link rel="prefetch" href="/vueblog/assets/js/12.b7c7a473.js"><link rel="prefetch" href="/vueblog/assets/js/13.bcdd9a69.js"><link rel="prefetch" href="/vueblog/assets/js/14.4ef60985.js"><link rel="prefetch" href="/vueblog/assets/js/15.eadc1f16.js"><link rel="prefetch" href="/vueblog/assets/js/16.8cd4ac1d.js"><link rel="prefetch" href="/vueblog/assets/js/17.4c6eb07c.js"><link rel="prefetch" href="/vueblog/assets/js/18.604dc414.js"><link rel="prefetch" href="/vueblog/assets/js/19.680333a9.js"><link rel="prefetch" href="/vueblog/assets/js/2.d2666a5a.js"><link rel="prefetch" href="/vueblog/assets/js/20.c1ac332d.js"><link rel="prefetch" href="/vueblog/assets/js/21.32d48dc9.js"><link rel="prefetch" href="/vueblog/assets/js/22.0b05bbff.js"><link rel="prefetch" href="/vueblog/assets/js/23.20dcf299.js"><link rel="prefetch" href="/vueblog/assets/js/24.797a5d9a.js"><link rel="prefetch" href="/vueblog/assets/js/26.3416257d.js"><link rel="prefetch" href="/vueblog/assets/js/27.21655063.js"><link rel="prefetch" href="/vueblog/assets/js/28.e3172734.js"><link rel="prefetch" href="/vueblog/assets/js/29.ae073ac8.js"><link rel="prefetch" href="/vueblog/assets/js/3.db55bc90.js"><link rel="prefetch" href="/vueblog/assets/js/30.bff53c8b.js"><link rel="prefetch" href="/vueblog/assets/js/31.2a4354c1.js"><link rel="prefetch" href="/vueblog/assets/js/32.93ef2d63.js"><link rel="prefetch" href="/vueblog/assets/js/33.4e80798b.js"><link rel="prefetch" href="/vueblog/assets/js/34.86db27ea.js"><link rel="prefetch" href="/vueblog/assets/js/35.c2f6907a.js"><link rel="prefetch" href="/vueblog/assets/js/36.4e1d51bf.js"><link rel="prefetch" href="/vueblog/assets/js/37.e8703fc1.js"><link rel="prefetch" href="/vueblog/assets/js/38.009e7cf7.js"><link rel="prefetch" href="/vueblog/assets/js/39.14cddf42.js"><link rel="prefetch" href="/vueblog/assets/js/4.60c9c8ac.js"><link rel="prefetch" href="/vueblog/assets/js/40.8b66ecef.js"><link rel="prefetch" href="/vueblog/assets/js/41.4657fc0d.js"><link rel="prefetch" href="/vueblog/assets/js/42.1717e97e.js"><link rel="prefetch" href="/vueblog/assets/js/43.2c166830.js"><link rel="prefetch" href="/vueblog/assets/js/44.2a16ca95.js"><link rel="prefetch" href="/vueblog/assets/js/45.1a8cda16.js"><link rel="prefetch" href="/vueblog/assets/js/46.c3b8e30d.js"><link rel="prefetch" href="/vueblog/assets/js/47.aa4b7dc2.js"><link rel="prefetch" href="/vueblog/assets/js/48.2bcc3370.js"><link rel="prefetch" href="/vueblog/assets/js/49.8a32e349.js"><link rel="prefetch" href="/vueblog/assets/js/5.4216761d.js"><link rel="prefetch" href="/vueblog/assets/js/50.99b1935d.js"><link rel="prefetch" href="/vueblog/assets/js/51.d3e4f00b.js"><link rel="prefetch" href="/vueblog/assets/js/52.4e0c21e1.js"><link rel="prefetch" href="/vueblog/assets/js/53.838e4e42.js"><link rel="prefetch" href="/vueblog/assets/js/54.2186c83c.js"><link rel="prefetch" href="/vueblog/assets/js/55.2acdd06f.js"><link rel="prefetch" href="/vueblog/assets/js/6.364979c9.js"><link rel="prefetch" href="/vueblog/assets/js/7.f092bbd1.js"><link rel="prefetch" href="/vueblog/assets/js/9.587698b9.js">
    <link rel="stylesheet" href="/vueblog/assets/css/0.styles.13617540.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout" data-v-7f2e4136><header class="header-container" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(../../../../../post-bg.jpeg);" data-v-93921ff8 data-v-7f2e4136><nav class="navbar" style="position:absolute;opacity:1;transition:all 0.5s ease-in-out;" data-v-93921ff8><a href="/vueblog/" class="navbar-link router-link-active">
    ALeeLee Blog
  </a> <ul class="navbar-links"><li><a href="/vueblog/" class="router-link-active">
        HOME
      </a></li><li><a href="/vueblog/about/">
        ABOUT
      </a></li><li><a href="/vueblog/tags/">
        TAGS
      </a></li></ul> <div id="nav-icon"><span></span><span></span><span></span></div></nav> <div class="header-title" data-v-93921ff8 data-v-93921ff8><h1 data-v-93921ff8>dns协议</h1> <p data-v-93921ff8></p></div></header> <div class="container" data-v-b3fda33c data-v-7f2e4136><main class="main" style="width:60%;" data-v-b3fda33c><div class="post" data-v-b3fda33c data-v-b3fda33c><article class="main-div"><div class="post-content content content__default"><p>本篇博客主要是 介绍dns协议</p> <h2 id="_1-dns-协议是什么"><a href="#_1-dns-协议是什么" class="header-anchor">#</a> 1. DNS 协议是什么</h2> <p><strong>概念</strong>： DNS 是域名系统 (Domain Name System) 的缩写，提供的是一种主机名到 IP 地址的转换服务，就是我们常说的域名系统。它是一个由分层的 DNS 服务器组成的分布式数据库，是定义了主机如何查询这个分布式数据库的方式的应用层协议。能够使人更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。</p> <p><strong>作用</strong>： 将域名解析为IP地址，客户端向DNS服务器（DNS服务器有自己的IP地址）发送域名查询请求，DNS服务器告知客户机Web服务器的 IP 地址。</p> <h2 id="_2-dns同时使用tcp和udp协议？"><a href="#_2-dns同时使用tcp和udp协议？" class="header-anchor">#</a> 2. DNS同时使用TCP和UDP协议？</h2> <p><strong>DNS占用53号端口，同时使用TCP和UDP协议。</strong> （1）在区域传输的时候使用TCP协议</p> <ul><li>辅域名服务器会定时（一般3小时）向主域名服务器进行查询以便了解数据是否有变动。如有变动，会执行一次区域传送，进行数据同步。区域传送使用TCP而不是UDP，因为数据同步传送的数据量比一个请求应答的数据量要多得多。</li> <li>TCP是一种可靠连接，保证了数据的准确性。</li></ul> <p>（2）在域名解析的时候使用UDP协议</p> <ul><li>客户端向DNS服务器查询域名，一般返回的内容都不超过512字节，用UDP传输即可。不用经过三次握手，这样DNS服务器负载更低，响应更快。理论上说，客户端也可以指定向DNS服务器查询时用TCP，但事实上，很多DNS服务器进行配置的时候，仅支持UDP查询包。</li></ul> <h2 id="_3-dns完整的查询过程"><a href="#_3-dns完整的查询过程" class="header-anchor">#</a> 3. DNS完整的查询过程</h2> <p>DNS服务器解析域名的过程：</p> <ul><li>首先会在<strong>浏览器的缓存</strong>中查找对应的IP地址，如果查找到直接返回，若找不到继续下一步</li> <li>将请求发送给<strong>本地DNS服务器</strong>，在本地域名服务器缓存中查询，如果查找到，就直接将查找结果返回，若找不到继续下一步</li> <li>本地DNS服务器向<strong>根域名服务器</strong>发送请求，根域名服务器会返回一个所查询域的顶级域名服务器地址</li> <li>本地DNS服务器向<strong>顶级域名服务器</strong>发送请求，接受请求的服务器查询自己的缓存，如果有记录，就返回查询结果，如果没有就返回相关的下一级的权威域名服务器的地址</li> <li>本地DNS服务器向<strong>权威域名服务器</strong>发送请求，域名服务器返回对应的结果</li> <li>本地DNS服务器将返回结果保存在缓存中，便于下次使用</li> <li>本地DNS服务器将返回结果返回给浏览器</li></ul> <p>比如要查询 <a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.baidu.com%2F" target="_blank" rel="noopener noreferrer">www.baidu.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 IP 地址，首先会在浏览器的缓存中查找是否有该域名的缓存，如果不存在就将请求发送到本地的 DNS 服务器中，本地DNS服务器会判断是否存在该域名的缓存，如果不存在，则向根域名服务器发送一个请求，根域名服务器返回负责 .com 的顶级域名服务器的 IP 地址的列表。然后本地 DNS 服务器再向其中一个负责 .com 的顶级域名服务器发送一个请求，负责 .com 的顶级域名服务器返回负责 .baidu 的权威域名服务器的 IP 地址列表。然后本地 DNS 服务器再向其中一个权威域名服务器发送一个请求，最后权威域名服务器返回一个对应的主机名的 IP 地址列表。</p> <h2 id="_4-迭代查询与递归查询"><a href="#_4-迭代查询与递归查询" class="header-anchor">#</a> 4. 迭代查询与递归查询</h2> <p>实际上，DNS解析是一个包含迭代查询和递归查询的过程。</p> <ul><li><strong>递归查询</strong>指的是查询请求发出后，域名服务器代为向下一级域名服务器发出请求，最后向用户返回查询的最终结果。使用递归 查询，用户只需要发出一次查询请求。</li> <li><strong>迭代查询</strong>指的是查询请求后，域名服务器返回单次查询的结果。下一级的查询由用户自己请求。使用迭代查询，用户需要发出 多次的查询请求。</li></ul> <p>一般我们向本地 DNS 服务器发送请求的方式就是递归查询，因为我们只需要发出一次请求，然后本地 DNS 服务器返回给我 们最终的请求结果。而本地 DNS 服务器向其他域名服务器请求的过程是迭代查询的过程，因为每一次域名服务器只返回单次 查询的结果，下一级的查询由本地 DNS 服务器自己进行。</p> <h2 id="_5-dns-记录和报文"><a href="#_5-dns-记录和报文" class="header-anchor">#</a> 5. DNS 记录和报文</h2> <p>DNS 服务器中以资源记录的形式存储信息，每一个 DNS 响应报文一般包含多条资源记录。一条资源记录的具体的格式为</p> <div class="language-http extra-class"><pre class="language-http"><code>（Name，Value，Type，TTL）
</code></pre></div><p>其中 TTL 是资源记录的生存时间，它定义了资源记录能够被其他的 DNS 服务器缓存多长时间。</p> <p>常用的一共有四种 Type 的值，分别是 A、NS、CNAME 和 MX ，不同 Type 的值，对应资源记录代表的意义不同：</p> <ul><li>如果 Type = A，则 Name 是主机名，Value 是主机名对应的 IP 地址。因此一条记录为 A 的资源记录，提供了标 准的主机名到 IP 地址的映射。</li> <li>如果 Type = NS，则 Name 是个域名，Value 是负责该域名的 DNS 服务器的主机名。这个记录主要用于 DNS 链式 查询时，返回下一级需要查询的 DNS 服务器的信息。</li> <li>如果 Type = CNAME，则 Name 为别名，Value 为该主机的规范主机名。该条记录用于向查询的主机返回一个主机名 对应的规范主机名，从而告诉查询主机去查询这个主机名的 IP 地址。主机别名主要是为了通过给一些复杂的主机名提供 一个便于记忆的简单的别名。</li> <li>如果 Type = MX，则 Name 为一个邮件服务器的别名，Value 为邮件服务器的规范主机名。它的作用和 CNAME 是一 样的，都是为了解决规范主机名不利于记忆的缺点。</li></ul></div></article> <!----></div></main> <aside class="aside" data-v-b3fda33c data-v-b3fda33c><div class="info-card main-div" data-v-1311ce9e data-v-b3fda33c><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(./avatar-bg.jpeg);" data-v-1311ce9e><img src="./avatar-top.jpg" alt="ALeeLee" class="info-avatar" data-v-1311ce9e></div> <div class="info-card-body" data-v-1311ce9e><section class="info-name" data-v-1311ce9e>
      ALeeLee
    </section> <section class="info-desc" data-v-1311ce9e>In me the tiger sniffs the rose<br/>心有猛虎，细嗅蔷薇</section> <section class="info-contact" data-v-1311ce9e><section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-location" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          Chongqing, China
        </span></span></section> <!----> <section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-email" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          992120608@qq.com
        </span></span></section></section></div> <div class="info-card-footer" data-v-1311ce9e><p class="footer-sns-link" data-v-1311ce9e><a target="_blank" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-jianshu" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" href="" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-weibo" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-zhihu" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a><a target="_blank" class="sns-link" data-v-1311ce9e><span class="sns-icon" data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:35px;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-github" data-v-1311ce9e data-v-1311ce9e></use></svg></span></a></p></div></div> <div class="post-toc main-div aside-toc" style="position:relative;top:0;width:0px;" data-v-b3fda33c><h4>- CATALOG</h4> <div class="post-nav-toc"><ul><li><a href="/vueblog/posts/2022/07/29/dns%E5%8D%8F%E8%AE%AE.html#_1-dns-协议是什么">1. DNS 协议是什么</a></li><li><a href="/vueblog/posts/2022/07/29/dns%E5%8D%8F%E8%AE%AE.html#_2-dns同时使用tcp和udp协议？">2. DNS同时使用TCP和UDP协议？</a></li><li><a href="/vueblog/posts/2022/07/29/dns%E5%8D%8F%E8%AE%AE.html#_3-dns完整的查询过程">3. DNS完整的查询过程</a></li><li><a href="/vueblog/posts/2022/07/29/dns%E5%8D%8F%E8%AE%AE.html#_4-迭代查询与递归查询">4. 迭代查询与递归查询</a></li><li><a href="/vueblog/posts/2022/07/29/dns%E5%8D%8F%E8%AE%AE.html#_5-dns-记录和报文">5. DNS 记录和报文</a></li></ul></div></div></aside></div> <footer class="footer" data-v-7f2e4136><p class="footer-sns-link"><a target="_blank" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-jianshu"></use></svg></span></a><a target="_blank" href="" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-weibo"></use></svg></span></a><a target="_blank" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-zhihu"></use></svg></span></a><a target="_blank" class="sns-link"><span class="sns-icon"><svg class="icon" style="font-size:40px;"><use xlink:href="#icon-github"></use></svg></span></a></p> <div class="copyright"><span id="custom">Copyright &copy; ALeeLee Blog 2020 <br /> 
      Theme By <a href="https://www.vuepress.cn/" target="_blank">VuePress</a>
      | <a href="https://www.github.com/youdeliang/" target="_blank">youdeliang</a></span> <iframe frameborder="0" scrolling="0" width="80px" height="20px" class="footer-btn" style="margin-left: 2px; margin-bottom:-5px;"></iframe></div></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/vueblog/assets/js/app.fdc44102.js" defer></script><script src="/vueblog/assets/js/8.890bf07c.js" defer></script><script src="/vueblog/assets/js/25.41573d9b.js" defer></script>
  </body>
</html>
